<div class="community-container">
  <header class="community-header">
    <h1>K√∂z√∂ss√©gi Port√°l</h1>
    <p>Maradj naprak√©sz a leg√∫jabb h√≠rekkel, friss√≠t√©sekkel √©s k√∂z√∂ss√©gi esem√©nyekkel</p>
  </header>

  <div class="community-content">
    <main class="articles-section">
      <div class="filters">
        <div class="search-box">
          <input 
            type="text" 
            [(ngModel)]="searchTerm" 
            (input)="filterArticles()"
            placeholder="Keres√©s cikkek k√∂z√∂tt..."
            class="search-input"
          >
          <span class="search-icon">üîç</span>
        </div>
        
        <div class="category-filters">
          <button 
            *ngFor="let category of categories"
            [class.active]="selectedCategory === category.id"
            (click)="selectedCategory = category.id; filterArticles()"
            class="category-btn"
          >
            {{ category.name }}
          </button>
        </div>
      </div>

      <div class="articles-list">
        <div *ngFor="let article of pagedArticles" class="article-card" (click)="openArticleModal(article)">
          <div class="article-header">
            <span 
              class="article-category"
              [style.backgroundColor]="getCategoryColor(article.category)"
            >
              {{ getCategoryName(article.category) }}
            </span>
            <span class="article-date">{{ article.date }}</span>
          </div>

          <h3 class="article-title">{{ article.title }}</h3>
          <p class="article-content">{{ article.content }}</p>
          
          <div class="article-footer">
            <div class="article-meta">
              <span class="article-author">√çrta: {{ article.author }}</span>
              <div class="article-stats">
                <button 
                  class="like-btn" 
                  [class.active]="isArticleLiked(article)"
                  (click)="likeArticle(article, $event)"
                >
                  üëç {{ article.likes }}
                </button>
                <span class="comments-count">
                  üí¨ {{ article.commentsCount }} hozz√°sz√≥l√°s
                </span>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="pagedArticles.length === 0" class="no-results">
          <p>Nincs tal√°lat a keres√©si felt√©telek alapj√°n.</p>
        </div>
      </div>

      <div *ngIf="filteredArticles.length > itemsPerPage" class="pagination-container">
        <div class="pagination">
          <button 
            class="page-btn prev-btn" 
            [disabled]="currentPage === 1"
            (click)="prevPage()"
          >
            &laquo; El≈ëz≈ë
          </button>
          
          <div class="page-numbers">
            <button 
              *ngFor="let page of pages"
              class="page-number"
              [class.active]="page === currentPage"
              (click)="goToPage(page)"
            >
              {{ page }}
            </button>
          </div>
          
          <button 
            class="page-btn next-btn" 
            [disabled]="currentPage === totalPages"
            (click)="nextPage()"
          >
            K√∂vetkez≈ë &raquo;
          </button>
        </div>
        
        <div class="pagination-info">
          <span>
            {{ getMin(currentPage * itemsPerPage, filteredArticles.length) }} - 
            {{ getMax((currentPage - 1) * itemsPerPage + 1, 1) }} / 
            {{ filteredArticles.length }} cikk
          </span>
          <span class="page-indicator">
            Oldal: {{ currentPage }} / {{ totalPages }}
          </span>
        </div>
      </div>
    </main>

    <aside class="comments-section">
      <div class="comments-header">
        <h2>üí¨ Hozz√°sz√≥l√°sok</h2>
        <p>Vegy√©l r√©szt a besz√©lget√©sben!</p>
      </div>

      <div class="new-comment-form">
        <h3>√öj hozz√°sz√≥l√°s √≠r√°sa</h3>
        <p *ngIf="currentUser !== 'Guest'" class="user-info">
          Bejelentkezve mint: <strong>{{ currentUser }}</strong>
        </p>
        <p *ngIf="currentUser === 'Guest'" class="user-info warning">
          K√©rj√ºk jelentkezz be a hozz√°sz√≥l√°shoz!
        </p>
        <div class="form-group">
          <textarea 
            [(ngModel)]="newComment.content"
            placeholder="√çrd meg hozz√°sz√≥l√°sodat..."
            rows="4"
            class="form-textarea"
            [disabled]="currentUser === 'Guest'"
          ></textarea>
        </div>
        <button class="submit-btn" (click)="addComment()" [disabled]="currentUser === 'Guest'">
          Hozz√°sz√≥l√°s k√ºld√©se
        </button>
      </div>

      <div class="comments-list">
        <h3>Leg√∫jabb kommentek</h3>
        
        <div *ngFor="let comment of comments.slice(0, 5)" class="comment-card">
          <div class="comment-header">
            <span class="comment-author">{{ comment.author }}</span>
            <span class="comment-date">{{ comment.date }}</span>
          </div>
          <div class="comment-content">{{ comment.content }}</div>
          <div class="comment-footer">
            <button 
              class="like-btn" 
              [class.active]="isCommentLiked(comment)"
              (click)="likeComment(comment)"
            >
              üëç {{ comment.likes }}
            </button>
          </div>
        </div>
        
        <div *ngIf="comments.length === 0" class="no-comments">
          Nincsenek kommentek m√©g.
        </div>
      </div>

      <footer class="community-footer">
        <p>¬© 2026 MDMPort | Minden jog fenntartva</p>
      </footer>
    </aside>
  </div>
</div>

<div class="modal-overlay" [class.active]="isModalOpen" (click)="closeModal($event)">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <button class="modal-close-btn" (click)="closeModal()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
    
    <div class="modal-content" *ngIf="selectedArticle">
      <div class="modal-article-side">
        <div class="modal-article-header">
          <span 
            class="modal-article-category"
            [style.backgroundColor]="getCategoryColor(selectedArticle.category)"
          >
            {{ getCategoryName(selectedArticle.category) }}
          </span>
          <span class="modal-article-date">{{ selectedArticle.date }}</span>
        </div>
        
        <h2 class="modal-article-title">{{ selectedArticle.title }}</h2>
        
        <div class="modal-article-author">
          <span class="author-avatar">{{ selectedArticle.author.charAt(0) }}</span>
          <span class="author-name">√çrta: {{ selectedArticle.author }}</span>
        </div>
        
        <div class="modal-article-content">
          <p>{{ selectedArticle.content }}</p>
        </div>
        
        <div class="modal-article-stats">
          <button 
            class="modal-like-btn" 
            [class.active]="isArticleLiked(selectedArticle)"
            (click)="likeArticle(selectedArticle)"
          >
            üëç {{ selectedArticle.likes }}
          </button>
          <span class="modal-comments-count">
            üí¨ {{ selectedArticle.commentsCount }} hozz√°sz√≥l√°s
          </span>
        </div>
      </div>
      
      <div class="modal-comments-side">
        <div class="modal-comments-header">
          <h3>üí¨ Hozz√°sz√≥l√°sok ({{ selectedArticle.commentsCount }})</h3>
        </div>
        
        <div class="modal-new-comment">
          <p *ngIf="currentUser !== 'Guest'" class="user-info">
            Bejelentkezve mint: <strong>{{ currentUser }}</strong>
          </p>
          <p *ngIf="currentUser === 'Guest'" class="user-info warning">
            K√©rj√ºk jelentkezz be a hozz√°sz√≥l√°shoz!
          </p>
          <div class="form-group">
            <textarea 
              [(ngModel)]="modalNewComment.content"
              placeholder="√çrd meg hozz√°sz√≥l√°sodat..."
              rows="3"
              class="form-textarea"
              [disabled]="currentUser === 'Guest'"
            ></textarea>
          </div>
          <button class="submit-btn" (click)="addCommentToArticle(selectedArticle.id)" [disabled]="currentUser === 'Guest'">
            Hozz√°sz√≥l√°s k√ºld√©se
          </button>
        </div>
        
        <div class="modal-comments-list">
          <div *ngFor="let comment of getCommentsForArticle(selectedArticle.id)" class="modal-comment-card">
            <div class="modal-comment-header">
              <span class="modal-comment-author">{{ comment.author }}</span>
              <span class="modal-comment-date">{{ comment.date }}</span>
            </div>
            <div class="modal-comment-content">{{ comment.content }}</div>
            <div class="modal-comment-footer">
              <button 
                class="modal-like-btn small" 
                [class.active]="isCommentLiked(comment)"
                (click)="likeComment(comment)"
              >
                üëç {{ comment.likes }}
              </button>
            </div>
          </div>
          
          <div *ngIf="getCommentsForArticle(selectedArticle.id).length === 0" class="no-comments-modal">
            M√©g nincsenek hozz√°sz√≥l√°sok. Legy√©l te az els≈ë!
          </div>
        </div>
      </div>
    </div>
  </div>
</div>