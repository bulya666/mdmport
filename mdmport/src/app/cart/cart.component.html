<main class="container">
  <section class="hero" style="display:flex;justify-content:flex-start;gap:40px">
    <div style="flex:1;max-width:600px">
      <h2>Kosár</h2>

      <div *ngIf="cartItems.length > 0; else emptyCart">
        <div
          *ngFor="let item of cartItems"
          style="display:flex;align-items:flex-start;gap:16px;margin-bottom:20px;border-bottom:1px solid #2a2a2a;padding-bottom:12px"
        >
        <div>
          <img
            id="m-cover"
            [src]="item.image"
            alt="{{ item.name }}"
            style="width:200px;max-width:100%;border-radius:6px;object-fit:cover;display:block;margin-bottom:8px"
          />
        </div>

          <div style="flex:1">
            <h3 style="margin:0 0 6px 0">{{ item.name }}</h3>
            <p *ngIf="item.price > 0" style="font-weight:600;color:#bff39b">
              ${{ item.price.toFixed(2) }}
            </p>
            <p *ngIf="item.price === 0" style="color:#bff39b">Free</p>
            <button (click)="removeFromCart(item)" class="remove">Eltávolítás</button>
          </div>
        </div>

        <div style="display:flex;align-items:center;gap:16px;margin-top:20px">
          <p style="margin:0;font-weight:700;color:#bff39b">
            Összesen: ${{ getTotal().toFixed(2) }}
          </p>
        <button (click)="purchase()" class="purchase"
                onmouseover="this.style.backgroundColor='#43a047'"
                onmouseout="this.style.backgroundColor='#4caf50'">
          Vásárlás
        </button> 

        </div>
      </div>

      <ng-template #emptyCart>
        <p>A kosarad üres.</p>
      </ng-template>
    </div>
  </section>
</main>

<div *ngIf="loadingPopup" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.65);display:flex;justify-content:center;align-items:center;z-index:9999">
  <div style="background:#1e1e1e;padding:22px 30px;border-radius:10px;display:flex;flex-direction:column;align-items:center;gap:18px;">

    <div *ngIf="!loadingDone" class="spinner"></div>

    <div *ngIf="loadingDone" style="font-size:48px;color:#4caf50;">✔</div>

    <p style="margin:0;font-size:17px;">
      {{ loadingDone ? 'Fizetés sikeres' : 'Fizetés folyamatban...' }}
    </p>

  </div>
</div>
<!-- notification overlay -->
<div class="notification" 
     *ngIf="notification.visible" 
     [ngClass]="notification.type">
  <div class="notification-inner">
    <div class="notification-icon">
      <span *ngIf="notification.type === 'success'">✔</span>
      <span *ngIf="notification.type === 'error'">✖</span>
      <span *ngIf="notification.type === 'warning'">⚠</span>
      <span *ngIf="notification.type === 'info'">ℹ</span>
    </div>
    <div class="notification-text">
      {{ notification.message }}
    </div>
    <button class="notification-close" (click)="notification.visible = false">
      ✕
    </button>
  </div>
</div>
