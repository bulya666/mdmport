<main class="cart-container">
  <h1 class="page-title">Kos√°r</h1>

  <div class="cart-content">
    <ng-container *ngIf="cartItems.length > 0; else empty">
      <div class="cart-items">
        <div class="cart-item" *ngFor="let item of cartItems">
          <img [src]="item.image" [alt]="item.name" class="item-cover" />

          <div class="item-info">
            <h3 class="item-title">{{ item.name }}</h3>
            <div class="item-price">
              <ng-container *ngIf="item.price > 0">
                {{ item.price | currency:'USD':'symbol':'1.2-2' }}
              </ng-container>
              <span *ngIf="item.price === 0" class="free-tag">Ingyenes</span>
            </div>
          </div>

          <button class="btn btn-remove" (click)="removeItem(item)">
            Elt√°vol√≠t√°s
          </button>
        </div>
      </div>

      <div class="cart-summary">
        <div class="total">
          <span>√ñsszesen:</span>
          <strong>{{ total | currency:'USD':'symbol':'1.2-2' }}</strong>
        </div>

        <button class="btn btn-purchase" (click)="executePurchase()" [disabled]="isLoading">
          {{ isLoading ? 'Feldolgoz√°s...' : 'V√°s√°rl√°s' }}
        </button>
      </div>
    </ng-container>

    <ng-template #empty>
      <div class="empty-cart">
        <div class="empty-icon">üõí</div>
        <h2>A kosarad √ºres</h2>
        <p>Fedezz fel √∫j j√°t√©kokat a boltban!</p>
        <button class="btn btn-outline" (click)="toStore()">
          Bolt megtekint√©se
        </button>
      </div>
    </ng-template>
  </div>

  <div class="loading-overlay" *ngIf="isLoading || isPurchaseSuccess">
    <div class="loading-card">
      <div class="spinner" *ngIf="!isPurchaseSuccess"></div>
      <div class="success-check" *ngIf="isPurchaseSuccess">‚úì</div>
      <p>
        {{ isPurchaseSuccess ? 'Sikeres v√°s√°rl√°s!' : 'Fizet√©s folyamatban...' }}
      </p>
    </div>
  </div>
  <div class="confirm-overlay" *ngIf="showConfirmDialog">
    <div class="confirm-card">
      <h3>Biztosan meg szeretn√©d v√°s√°rolni?</h3>
      <p>√ñsszesen: <strong>{{ total | currency:'USD':'symbol':'1.2-2' }}</strong></p>

      <div class="confirm-buttons">
        <button class="btn btn-cancel" (click)="cancelPurchase()">
          M√©gse
        </button>
        <button class="btn btn-confirm" (click)="executePurchase()" [disabled]="isLoading">
          Igen, v√°s√°rl√°s!
        </button>
      </div>
    </div>
  </div>
  <div class="toast" *ngIf="notification.show" [ngClass]="['toast--' + notification.type]">
    <span class="toast-icon">
      {{ notification.type === 'success' ? '‚úì' :
      notification.type === 'error' ? '‚úï' :
      notification.type === 'warning' ? '‚ö†' : '‚Ñπ' }}
    </span>
    <span class="toast-message">{{ notification.message }}</span>
  </div>
</main>